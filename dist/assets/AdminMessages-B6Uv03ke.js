import{j as e}from"./ui-vendor-CbTtZHsW.js";import{a as s}from"./react-vendor-1XlI0agO.js";import{u as a}from"./useContactMessages-DqN6Ij8A.js";import{B as t}from"./button-D-ffmNcE.js";import{I as r}from"./input-m9ePOgnC.js";import{a as l,b as i,c as d,C as c}from"./card-PHeom2L9.js";import{B as m}from"./badge-Db9_b52h.js";import{c as n,b as o}from"./index-BWpasF73.js";import{M as x}from"./message-square-CHm2jBUy.js";import{S as h}from"./search-BmT2NVnk.js";import{C as p}from"./chevron-right-DqnxfF0a.js";import{U as u}from"./user-D-Czru7T.js";import{T as f}from"./trash-2-B78Q9GXL.js";import{P as j}from"./phone-CN7aDeEm.js";import{M as g}from"./mail-Bi5-Lunt.js";import{f as N}from"./format-v08Horlk.js";import{a as v}from"./ar-DZ-DN8Lq_Uj.js";import"./query-vendor-DL9dZapS.js";const w=n("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),b=()=>{const{messages:n,isLoading:b,updateMessage:y,deleteMessage:C}=a(),[M,k]=s.useState(null),[L,D]=s.useState(""),{toast:P}=o(),S=n?.filter(e=>e.name.toLowerCase().includes(L.toLowerCase())||e.phone.includes(L)||e.email&&e.email.toLowerCase().includes(L.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(x,{className:"w-6 h-6 text-primary"}),"Contact Messages"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and respond to client inquiries"})]}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(h,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(r,{placeholder:"Search messages...",className:"pl-10",value:L,onChange:e=>D(e.target.value)})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1 space-y-4",children:e.jsxs(l,{className:"h-[calc(100vh-250px)] overflow-hidden flex flex-col",children:[e.jsx(i,{className:"py-3 border-b",children:e.jsx(d,{className:"text-sm font-medium",children:"Messages History"})}),e.jsx(c,{className:"p-0 overflow-y-auto flex-1",children:b?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"Loading..."}):0===S?.length?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"No messages found."}):e.jsx("div",{className:"divide-y",children:S?.map(s=>e.jsxs("button",{onClick:()=>k(s),className:"w-full text-left p-4 hover:bg-muted/50 transition-colors flex items-start gap-3 "+(M?.id===s.id?"bg-muted":""),children:[e.jsx("div",{className:"w-2 h-2 mt-2 rounded-full flex-shrink-0 "+("new"===s.status?"bg-primary":"bg-transparent")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("p",{className:"font-semibold truncate",children:s.name}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:N(new Date(s.created_at),"MMM dd")})]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.message}),e.jsxs("div",{className:"mt-2 flex gap-2",children:["read"===s.status&&e.jsx(m,{variant:"outline",className:"text-[10px] py-0",children:"Read"}),"new"===s.status&&e.jsx(m,{className:"text-[10px] py-0",children:"New"})]})]}),e.jsx(p,{className:"w-4 h-4 text-muted-foreground self-center"})]},s.id))})})]})}),e.jsx("div",{className:"lg:col-span-2",children:M?e.jsxs(l,{className:"h-full border-primary/20 bg-primary/5 shadow-sm",children:[e.jsx(i,{className:"border-b bg-card py-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(u,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx(d,{className:"text-lg",children:M.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Received ",N(new Date(M.created_at),"PPP pp",{locale:v})]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:["new"===M.status&&e.jsxs(t,{size:"sm",onClick:()=>(async(e,s)=>{try{await y({id:e,updatedFields:{status:s}}),P({title:"Success",description:`Message marked as ${s}.`}),M?.id===e&&k(e=>e?{...e,status:s}:null)}catch(a){P({title:"Error",description:"Failed to update message status.",variant:"destructive"})}})(M.id,"read"),className:"flex-1 md:flex-none",children:[e.jsx(w,{className:"w-4 h-4 mr-2"})," Mark as Read"]}),e.jsxs(t,{variant:"destructive",size:"sm",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this message?"))try{await C(e),P({title:"Deleted",description:"Message deleted successfully."}),k(null)}catch(s){P({title:"Error",description:"Failed to delete message.",variant:"destructive"})}})(M.id),className:"flex-1 md:flex-none",children:[e.jsx(f,{className:"w-4 h-4 mr-2"})," Delete"]})]})]})}),e.jsxs(c,{className:"bg-card min-h-[400px] p-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8 p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs font-semibold text-muted-foreground flex items-center gap-1 uppercase tracking-wider",children:[e.jsx(j,{className:"w-3 h-3"})," Phone"]}),e.jsx("a",{href:`tel:${M.phone}`,className:"text-sm font-medium hover:text-primary transition-colors block",children:M.phone})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs font-semibold text-muted-foreground flex items-center gap-1 uppercase tracking-wider",children:[e.jsx(g,{className:"w-3 h-3"})," Email"]}),M.email?e.jsx("a",{href:`mailto:${M.email}`,className:"text-sm font-medium hover:text-primary transition-colors block underline",children:M.email}):e.jsx("span",{className:"text-sm text-muted-foreground italic tracking-tight",children:"Not provided"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-bold flex items-center gap-2 border-b pb-2",children:[e.jsx(x,{className:"w-4 h-4 text-primary"}),"Message Content"]}),e.jsx("div",{className:"bg-muted px-6 py-6 rounded-xl border border-border shadow-inner whitespace-pre-wrap font-body text-foreground leading-relaxed",children:M.message})]})]})]}):e.jsx(l,{className:"h-full flex items-center justify-center p-12 border-dashed border-2",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto opacity-50",children:e.jsx(x,{className:"w-8 h-8 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"No message selected"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose a message from the history to view its details."})]})]})})})]})]})};export{b as default};
